- name: intro
  steps: 
    - goto: introduction
    - goto: select-business-kind
    - goto: select-location
    - goto: choose-property-size
    - do:
        cmd: stacks_button_visible

- name: introduction
  steps:
    - img:
        mobile:
          asset: assets/img/bot-hi.png
          justify_content: flex-start
          width: '40%'
    - say: קוראים לי BR7, אני בוט קטן שמתמחה בעסקים קטנים בעיריית באר שבע
    - say: >
        עשרות מומחים בעירייה כתבו עבורי 
        מאות כרטיסי תוכן בנוגע לכל ההיבטים של פתיחת עסק:
        רישוי, ארנונה, שילוט, תכנון, חניה, מה לא...
    - say: >
        תיכף אשאל אותך 3 שאלות קצרות לגבי העסק שברצונך לפתוח,
        בעזרתן אוכל לתת לך את המידע הרלוונטי עבורך.
    - html-say: >
        חשוב לציין:<br/>
        לפי <a href='javascript:;' onclick='document.location.hash="menu:eula";'>תנאי השימוש שלי</a>, 
        המידע שאתן לך כאן הוא ראשוני וכללי. מומלץ להמשיך את התהליך עם אנשי המקצוע של העירייה, שיוכלו להנחות אותך בניואנסים הקטנים.
    - say:
        בהמשך השיחה אוכל לקשר אותך אל דקלה מיעדים (החברה העירונית לפיתוח עסקי), שתוכל ללוות אותך בכל התהליך.
    - say: נשמע טוב?
    - wait:
        options:
          - show: נשמע טוב.

- name: select-business-kind
  steps:
    - say: >
        יופי, אז נתחיל בשאלות: בתור התחלה אצטרך שנזהה יחד את סוג העסק שלך מתוך הרשימה.
    - wait:
        options:
          - show: יאללה
            echo: no
            steps:
              - select-from-list:
                  source: business_kinds
                  variable: business_kind
                  variable2: סוג_עסק
                  placeholder: חיפוש (מסעדה, מוסך, משרד…)
                  response: בחרתי {{סוג_עסק}}
              - say: נהדר!

          - show: עוד לא החלטתי מה לפתוח
            class: grayed
            steps:
              - say: בסדר גמור
              - say: יש לי כבר לא מעט מה לספר לך גם ככה
              - say: ואם ישארו לך שאלות בסוף, דקלה תשמח לעזור

- name: select-location
  steps:
    - say: >
        לשאלה הבאה: יעניין אותך לשמוע על מתחמים עסקיים בעיר, או שכבר בחרת מיקום?
    - wait:
        options:
          - show: אשמח לשמוע
            echo: false
            do:
              cmd: select_commercial_area
            # steps:
            #   - cards:
            #       stack: commercial-areas
            #       variable: location
            #       variable2: מיקום
            #       response: בחרתי {{location.title}}
          - show: כבר בחרתי מקום
            echo: false
            steps:
              - select-from-list:
                  source: locations
                  variable: location
                  variable2: מיקום
                  placeholder: חיפוש (כתובת העסק או שם מתחם עסקי…)
                  response: בחרתי {{מיקום.שם}}
              - say: נהדר!
          - show: אבחר אחר כך
            class: grayed
            steps:
              - say: אין בעיה
    - do:
        cmd: calculate_locations
        params:
          - record

- name: choose-property-size
  steps:
    - html-say: >
        ושאלה אחרונה:<br/>
        ידוע לך כבר גודל הנכס? זה יעזור לי לדייק את המידע שאציג בנוגע לרישוי העסק ולארנונה.
    - wait:
        options:
        - show: כן, יש לי גודל מדוייק
          echo: no
          steps:
            - wait:
                variable: גודל_נכס
                input-kind: number
                input-min: 1
                input-max: 100000
                placeholder: גודל הנכס במ״ר
                response: >
                  {{גודל_נכס}} מ״ר גודל
        - show: לא, אבל אתן גודל משוער
          echo: no
          steps:
            - wait:
                variable: גודל_נכס
                input-kind: number
                input-min: 1
                input-max: 100000
                placeholder: גודל הנכס המשוער במ״ר
                response: >
                  פחות או יותר {{גודל_נכס}} מ״ר גודל
        - show: אין לי מושג
          class: grayed
          steps:
            - say: אין בעיה :) 
    - say: מעולה! עכשיו אני יכול להתאים לך מידע רלוונטי.
